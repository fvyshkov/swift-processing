{
    "lists": {},
    "forms": {},
    "js": {},
    "methods": {
        "runCheckRule": {
            "sql": {},
            "script": {
                "py": "def runCheckRule(params):\n    with initDbSession(application='bank').cursor() as cursor:\n        p = {\n            'DEP_ID'    : params.get('dep_id'),\n            'ID'        : params.get('id'),\n            'RULE'      : params.get('rule'),\n        }\n        cursor.execute(\"\"\"\n            declare\n                idChk number;\n            begin\n                idChk := P_PkgErr_mng.fCode2Id(:RULE);\n                P_PkgErr.pRunErrbyOrd(\n                    idDep       => :DEP_ID,\n                    idOrd       => :ID,\n                    idChk       => idChk,\n                    iAutTrnFL   => 0,\n                    iClearFL    => 1\n                );\n            end;\n        /\"\"\", p)\n\nrunCheckRule(parameters)\n"
            }
        },
        "getCheckResultByRule": {
            "script": {
                "py": "import oracledb\ndef getCheckResultByRule(params):\n    with initDbSession(application='bank').cursor() as cursor:\n        p = {\n            'DEP_ID'    : params.get('dep_id'),\n            'ID'        : params.get('id'),\n            'RULE'      : params.get('rule'),\n            'RESULT'    : cursor.var(oracledb.CURSOR),\n        }\n        cursor.execute(\"\"\"\n            declare\n                idChk number;\n            begin\n                idChk := P_PkgErr_mng.fCode2Id(:RULE);\n                open :RESULT for\n                    select * from P_ORDERR\n                    where ORD_DEP_ID=:DEP_ID and ORD_ID=:ID\n                        and ID_ERR=any(\n                            select ID_ERR from P_CHKDSC_ERR where id_lev=idChk\n                        )\n                ;\n            end;\n        \"\"\", p)\n\n        ret_cursor = p['RESULT'].getvalue()\n        try:\n            r = fetchall(ret_cursor)\n        finally:\n            ret_cursor.close()\n            \n    return r\n\ndata = getCheckResultByRule(parameters)"
            }
        }
    },
    "references": {}
}