{
    "forms": {
        "selectDepartmentDialog": {
            "title": "Выбор подразделения",
            "className": "vertical",
            "style": {
                "marginTop": "8px"
            },
            "$": {
                "@fields": {
                    "className": "vertical",
                    "$": {
                        "@dep": {
                            "className": "horizontal",
                            "$": {
                                "department": {
                                    "label": "Подразделение",
                                    "style": {
                                        "width": "150px"
                                    },
                                    "required": true,
                                    "control": "ModuleComponent",
                                    "controlProps": {
                                        "componentPath": "/aoa/ObjectReference",
                                        "object": "department"
                                    },
                                    "controlOpts": {
                                        "valueField": "code",
                                        "postfixFields": {
                                            "Name": "name"
                                        },
                                        "referenceParams": {
                                            "parentCode$": "params?.parentCode",
                                            "filter$": "params?.filter"
                                        }
                                    }
                                },
                                "departmentName": {
                                    "label": "",
                                    "style": {
                                        "width": "450px"
                                    },
                                    "readOnly": true,
                                    "control": "TextEdit"
                                }
                            }
                        },
                        "comment": {
                            "label": "Комментарий",
                            "control": "TextEdit",
                            "controlProps": {
                                "multiline": true,
                                "minRows": 3
                            },
                            "visible$": "params.withComment || params.withCommentRequired",
                            "required$": "params.withCommentRequired"
                        }
                    }
                },
                "@buttons": {
                    "form": "dialogButtons"
                }
            }
        },
        "dialogButtons": {
            "className": "horizontal",
            "style": {
                "justifyContent": "end"
            },
            "$": {
                "btnCancel": {
                    "label": "Отменить",
                    "control": "Button",
                    "controlProps": {
                        "variant": "outlined",
                        "color": "primary"
                    },
                    "action": {
                        "name": "closeDialog"
                    }
                },
                "btnApply": {
                    "label": "Сохранить",
                    "control": "Button",
                    "controlProps": {
                        "variant": "contained",
                        "color": "primary"
                    },
                    "action": {
                        "name": "saveDepartment"
                    }
                }
            }
        }
    },
    "methods": {
        "get": {
            "query": {
                "params": []
            },
            "script": {
                "params": []
            }
        },
        "save": {},
        "delete": {},
        "getList": {}
    },
    "references": {
        "default": {
            "form": {
                "style": {
                    "width": "800px"
                },
                "columns": [
                    {
                        "title": "Код",
                        "field": "code",
                        "width": 240
                    },
                    {
                        "title": "Наименование",
                        "field": "name",
                        "flex": 1
                    }
                ],
                "primaryKey": "code",
                "parentKey": "parentCode"
            },
            "method": {
                "sql": {
                    "sqlType": "query",
                    "database": "cbs",
                    "params": [
                        "parentCode",
                        "filter"
                    ],
                    "sql": "select \n    c.CODE \"code\", \n    c.LONGNAME \"name\", \n    p.code \"parentCode\" \nfrom c_dep c, c_dep_std p \nwhere c.arcfl=0\n    and c.id_hi=p.id(+)\n    and (\n        :filter is null and (:parentCode is null and c.id_hi is null or :parentCode=p.code)\n        or :filter is not null \n            and exists(\n                select 1 from c_hiegrn nodes, c_hie filter\n                where nodes.id=filter.id and filter.name=:filter\n                    and nodes.id_node=c.id\n            )\n            and (\n                    :parentCode is null and not exists(\n                        select 1 from c_hiegrn nodes, c_hie filter\n                        where nodes.id=filter.id and filter.name=:filter\n                            and nodes.id_node=c.id_hi            \n                    )\n                    or\n                    :parentCode is not null and :parentCode=p.code\n                ) \n    )\norder by c.code"
                },
                "script": {
                    "params": []
                }
            }
        }
    },
    "lists": {}
}