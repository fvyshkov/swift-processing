{
    "forms": {
        "updateTask": {
            "title": "Обновление системы",
            "className": "vertical task task-panel",
            "style": {
                "height": "100%",
                "overflow": "hidden"
            },
            "$": {
                "@form": {
                    "style": {
                        "padding": "8px",
                        "overflow": "auto"
                    },
                    "form": "updateForm"
                }
            },
            "actions": {
                "onTaskCreated": [
                    {
                        "js": "context.nexusContext = {};"
                    }
                ]
            }
        },
        "updateForm": {
            "title": "Обновление системы",
            "className": "vertical",
            "$": {
                "@kuber": {
                    "className": "horizontal",
                    "$": {
                        "@deployment": {
                            "style": {
                                "width": "50%"
                            },
                            "object": "kube",
                            "form": "deploymentForm"
                        },
                        "@pods": {
                            "style": {
                                "height": "250px",
                                "width": "50%",
                                "overflow": "hidden"
                            },
                            "object": "kube",
                            "form": "podsForm"
                        }
                    }
                },
                "@g": {
                    "className": "horizontal",
                    "style": {
                        "height": "400px",
                        "overflowY": "hidden"
                    },
                    "$": {
                        "@gitlab_pipelines": {
                            "style": {
                                "width": "50%"
                            },
                            "object": "gitlab",
                            "form": "pipelinesForm",
                            "context$": "{}"
                        },
                        "@nexus_tags": {
                            "style": {
                                "width": "50%"
                            },
                            "object": "nexus",
                            "form": "componentsForm",
                            "context$": "context.nexusContext || {}"
                        }
                    }
                }
            },
            "actions": {
                "onInstallImage": {
                    "js": "frontend.dialog({object: 'update', form: 'installImageDialog', mem: {image: params.image}})"
                }
            }
        },
        "installImageDialog": {
            "title": "Установка приложения",
            "className": "vertical",
            "style": {
                "xheight": "600px",
                "width": "600px",
                "marginTop": "4px"
            },
            "$": {
                "@fields": {
                    "style": {
                        "flexGrow": 1
                    },
                    "$": {
                        "image": {
                            "className": "vertical",
                            "$": {
                                "version": {
                                    "label": "Версия",
                                    "control": "TextEdit"
                                },
                                ".date": {
                                    "label": "Дата",
                                    "control": "TextEdit",
                                    "getter": "formatters.datetime(mem?.assets?.[0]?.lastModified)"
                                }
                            }
                        }
                    }
                },
                "@buttons": {
                    "className": "horizontal",
                    "style": {
                        "justifyContent": "end"
                    },
                    "$": {
                        ".btnCancel": {
                            "label": "Отменить",
                            "control": "Button",
                            "controlProps": {
                                "variant": "outlined",
                                "color": "primary"
                            },
                            "action": {
                                "js": "actions.close();",
                                "disableUpdate": true
                            }
                        },
                        ".btnInstall": {
                            "label": "Установить",
                            "control": "Button",
                            "controlProps": {
                                "variant": "contained",
                                "color": "primary"
                            },
                            "action": [
                                {
                                    "js": "return backend.post('/aoa/execObjectMethod', {object: 'gitlab', method: 'runPipeline', params: {TAG: mem.image.version}})"
                                },
                                {
                                    "js": "backend.post('/site/report-error', {message: `Запущено обновление системы до версии ${mem.image.version}`})",
                                    "disableUpdate": true
                                },
                                {
                                    "js": "actions.close();",
                                    "disableUpdate": true
                                }
                            ]
                        }
                    }
                }
            }
        }
    },
    "methods": {},
    "reference": {
        "method": {}
    }
}