<workflow id="APP_SET_GOVERNMENT" name="Установика признака По решению правительства">
    <script id="96fafdd7-8670-4bf8-aea1-8008ca3734d9" name="Установка признака">
        <journal time="leave">
            <![CDATA[Установлен признак По решению правительства]]>
        </journal>
        <![CDATA[ok = pv.get('objectKey')
kv = ok.split(':')
pk = kv[1].split(',')
pv['dep_id'] = int(pk[0])
pv['id'] = int(pk[1])

from colvir_cbs.auth import AuthenticatedUser

with AuthenticatedUser():
    j = execObjectMethod({
        'object': 'app', 'method': 'getApplicationJson',
        'params': {'dep_id': pv['dep_id'], 'id': pv['id']}
    })

    j['product']['options']['hasGovernmentDecision'] = True
    j['government'] = {
        'hasDecision': True
    }
    execObjectMethod({
        'object': 'app', 'method': 'saveApplicationJson',
        'params': {'dep_id': pv['dep_id'], 'id': pv['id'], 'json': j}
    })

]]>
    </script>
</workflow>