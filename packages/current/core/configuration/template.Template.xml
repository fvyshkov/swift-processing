<?xml version="1.0" ?>
<model id="template.Template" name="Шаблон">
	<description><![CDATA[description['code'] = obj.code
description['name'] = obj.code
description['attrs'] = {
    'code': obj.code,
    'name': obj.name,
}
description['file_name'] = '%s.%s' % (obj.code, 'html')
description['file_path'] = 'template'
]]></description>
	<export><![CDATA[ 
import json
description = None
if obj.description:
    description = json.dumps(obj.description, indent=4, ensure_ascii=False)
template = obj.data.replace('\r', '')

file['data'] = '\n<!-- 7E5BC701-DDCB-5E05-76C2-11220A03F3A1 -->\n'.join(filter(lambda x: x is not None,[template, description]))

]]></export>
	<import><![CDATA[if object_attrs is None:
    raise Exception('Отсутствуют дополнительные атрибуты объекта, обновите пакет')
    
from apng_core.template.models import Template
try:
    obj = Template.objects.get(id=object_id)
except Template.DoesNotExist:
    obj = Template()
obj.id = object_id
obj.code = object_attrs['code']
obj.name = object_attrs['name']

fileSections = file_data.split('\n<!-- 7E5BC701-DDCB-5E05-76C2-11220A03F3A1 -->\n')
template = fileSections[0]
description = fileSections[1] if len(fileSections)>1 else None

obj.data = template
obj.description = description

obj._isImport = True
obj.save()
]]></import>
	<lookup><![CDATA[ ]]></lookup>
</model>
